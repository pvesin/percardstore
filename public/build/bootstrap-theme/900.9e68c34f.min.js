"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[900],{4900:(t,e,n)=>{n.r(e),n.d(e,{default:()=>u});var r=n(9755),o=n.n(r),i=n(6945);var a=n(3138);function c(t,e,n,r,o,i,a){try{var c=t[i](a),d=c.value}catch(t){return void n(t)}c.done?e(d):Promise.resolve(d).then(r,o)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){c(i,r,o,a,d,"next",t)}function d(t){c(i,r,o,a,d,"throw",t)}a(void 0)}))}}const l=function(){var t=d((function*(t,e,n="",r=null){const o={};r&&(o.signal=r.signal);const i=yield fetch(window.location.origin+t+"?"+e+"="+n,o);return yield i.json()}));return function(e,n){return t.apply(this,arguments)}}(),s=function(){var t=d((function*(t,e=""){const n=yield fetch(window.location.origin+t+"?code[]="+e);return yield n.json()}));return function(e){return t.apply(this,arguments)}}();o().fn.extend({productVariantAutoComplete(){this.each(((t,e)=>{const n=o()(e),r=n.data("criteria-name"),c=n.find("input.autocomplete"),d=n.find("input.dropdown-toggle"),u=n.find("img.dropdown-image"),p=n.data("url"),m=n.data("load-edit-url"),v=n.find("div.dropdown-menu");let f,h=null;new a.Lt(n);d.length&&(c.val()&&s(m,c.val()).then((t=>{d.val(t[0].descriptor),u.attr("src",t[0].image),h={code:c.val(),descriptor:t[0].descriptor,image:t[0].image}})),d[0].addEventListener("keydown",(0,i.Z)((()=>{v.empty(),v.append(o()("<span>",{class:"Loader d-block mx-auto"})),f&&(f.abort(),f=null),f=new AbortController,l(p,r,d.val(),f).then((t=>{v.empty(),t.length?t.forEach((t=>{v.append(o()(`<div class="item cursor-pointer" data-value="${t.code}" data-slug="${t.slug}">\n                                    <img class="rounded-circle" style="width: 2.5rem;" src="${t.image}">\n                                    <span>${t.descriptor}</span>\n                                </div>`).on("click",(()=>{c.val(t.code),d.val(t.descriptor),u.attr("src",t.image),h={code:t.code,descriptor:t.descriptor,image:t.image}})))})):v.append(Translator.trans("sylius.search.no_result"))}))}),1e3)),d[0].addEventListener("click",(()=>{c.val()&&(c.removeAttr("value"),d.val(""),u.removeAttr("src"))})),((t,e)=>{document.addEventListener("click",(n=>{t.contains(n.target)||e()}))})(d[0],(()=>{h&&(c.val(h.code),d.val(h.descriptor),u.attr("src",h.image))})))}))}});const u=()=>{o()(".sylius-autocomplete.dropdown").productVariantAutoComplete(),p()},p=()=>{const t=document.querySelector("form div[data-form-collection='list']");if(!t)return;new MutationObserver((t=>{t.forEach((({target:t})=>{t=t.children.item(t.children.length-1);o()(t).find(".sylius-autocomplete.dropdown").productVariantAutoComplete()}))})).observe(t,{childList:!0})}},6945:(t,e,n)=>{n.d(e,{Z:()=>r});const r=(t,e)=>{let n=null;return(...r)=>{clearTimeout(n),n=setTimeout((()=>t(...r)),e)}}}}]);